@model  Model.DTO.DTO_Ad.DTO_Product

<script src="~/ckeditor/styles.js"></script>
<script src="~/ckeditor/ckeditor.js"></script>

@{
  
    Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";
}

<h2>Thêm sản phẩm</h2>


@using (Html.BeginForm("Create", "Products_Add", FormMethod.Post, new { enctype = "multipart/form-data" }))
{
    @Html.AntiForgeryToken()

<div class="form-horizontal">
    <hr />
    @Html.ValidationSummary(true, "", new { @class = "text-danger" })
    <div class="form-group">
        Nhập Mã sản phẩm
        <div class="col-md-10">
            <input type="number" name="idSP" class="form-control" />
            @*@Html.EditorFor(model => model.Id_SanPham, new { htmlAttributes = new { @class = "form-control" } })
            @Html.ValidationMessageFor(model => model.Id_SanPham, "", new { @class = "text-danger" })*@
        </div>
    </div>
    @*<div class="form-group">
        Nhập Mã Item sản phẩm(Trùng với Mã sản phẩm)
        <div class="col-md-10">

            @Html.EditorFor(model => model.Item.Id_SanPham, new { htmlAttributes = new { @class = "form-control" } })
            @Html.ValidationMessageFor(model => model.Item.Id_SanPham, "", new { @class = "text-danger" })
        </div>
    </div>*@1

    <div class="form-group">
      Tên sản phẩm
        <div class="col-md-10">
            @Html.EditorFor(model => model.Name, new { htmlAttributes = new { @class = "form-control" } })
            @Html.ValidationMessageFor(model => model.Name, "", new { @class = "text-danger" })
        </div>
    </div>

    <div class="form-group">
     Giá sản phẩm
        <div class="col-md-10">
            @Html.EditorFor(model => model.Price, new { htmlAttributes = new { @class = "form-control" } })
            @Html.ValidationMessageFor(model => model.Price, "", new { @class = "text-danger" })
        </div>
    </div>
    <div class="form-group">
   Chi tiết sản phẩm
        <div class="col-md-10">
            @Html.TextAreaFor(model => model.Details@*, new { @id = "ckcon" }*@)
            <script type="text/javascript">
                CKEDITOR.replace("ckcon");
            </script>
        </div>
    </div>

    <div class="form-group">
      Hỉnh ảnh sản phẩm
        <div class="col-md-10">
            @Html.EditorFor(model => model.Photo, new { htmlAttributes = new { @class = "form-control" } })
            <img src="@Url.Content(Model.Photo)" style="height:200px; width:200px; margin:10px; " id="PreviewImage" />
            <input type="file" name="ImageUpload" id="ImageUpload" onchange="ShowImagePreview( document.getElementById('PreviewImage')" />
            @*<input type="file" id="fileUpload" name=" fileUpload" style="display:none" />
                <input type="button" id="btnUpload" value="..." class="btn btn-success" />*@
            @Html.ValidationMessageFor(model => model.Photo, "", new { @class = "text-danger" })
        </div>
    </div>
    <div class="form-group">
      Nhập Mã loại sản phẩm
        <div class="col-md-10">
            @Html.EditorFor(model => model.Id_Item, new { htmlAttributes = new { @class = "form-control " } })
            @Html.ValidationMessageFor(model => model.Id_Item, "", new { @class = "text-danger" })
        </div>
    </div>
    

    <script>
        function ShowImagePreview(imageUploader, PreviewImage) {
            if (imageUploader.flles && imageUploader.flles[0]) {
                var reader = new FileReader();
                reader.onload = function (e) {
                    $(PreviewImage).attr('src', e.target.result);
                }
                reader.readAsDataURL(imageUploader.flles[0]);
            };
        }
    </script>

    <div class="form-group">
        <div class="col-md-offset-2 col-md-10">
            <input type="submit" value="Create" class="btn btn-default" />
        </div>
    </div>
</div>
}

<div>
    @Html.ActionLink("Trở về", "Index")
</div>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")q
}
@section Upload {
    <script>
        $(function () {
            $('#btnUpload').click(function () {
                $('#fileUpload').trigger('click');
            });
            $('#fileUpload').change(function () {
                if (window.FormData !== undefined) {
                    var fileUpload = $('#fileUpload').get(0);
                    var files = fileUpload.files;
                    var formData = new FormData();
                    formData.append('file', files[0]);
                    $.ajax({
                        type: 'POST',
                        url: '/Products_Add/ProcessUpload',
                        contentTyle: false,
                        processData: false,
                        data: formData,
                        success: function (urlImage) {
                            $('#pictureUpload').attr('src', urlImage);

                        },
                        error: function (err) {
                            alert('có lỗi khi upload' + err.statusText);
                        }

                    });
                }

            });
        });
    </script>
}
